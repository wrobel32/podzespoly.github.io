<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TeamOrganizer - Zarzdzanie Zespoami</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>"
        type="image/svg+xml">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Dodanie Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        :root {
            --primary-color: #6A0DAD;
            --primary-light: #9B30FF;
            --primary-dark: #4B0082;
            --secondary-color: #8A2BE2;
            --secondary-light: #9370DB;
            --secondary-dark: #483D8B;
            --accent-color: #DA70D6;
            --accent-light: #EE82EE;
            --accent-dark: #BA55D3;
            --background-dark: #1a1a1a;
            --surface-dark: #2d2d2d;
            --card-dark: #3c3c3c;
            --text-primary: #f0f0f0;
            --text-secondary: #b0b0b0;
            --border-dark: #444;
            --border-light: #666;
            --success-color: #4CAF50;
            --warning-color: #FFC107;
            --info-color: #2196F3;
            --border-radius: 16px;
            --box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --transition: all 0.3s ease;
            --gradient-primary: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            --gradient-accent: linear-gradient(135deg, var(--accent-color) 0%, var(--primary-light) 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Roboto', sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--background-dark) 0%, #2a2a2a 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding-bottom: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            background: var(--surface-dark);
            box-shadow: var(--box-shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-dark);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--primary-light);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .logo-icon {
            font-size: 2rem;
        }

        .login-btn {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 30px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(106, 13, 173, 0.4);
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(106, 13, 173, 0.6);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid var(--primary-color);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
            object-fit: cover;
        }

        .user-name {
            font-weight: 500;
            color: var(--text-primary);
        }

        .tabs {
            display: flex;
            margin: 25px 0;
            background-color: var(--surface-dark);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            border: 1px solid var(--border-dark);
        }

        .tab {
            padding: 18px 30px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            flex: 1;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .tab::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 4px;
            background: var(--primary-color);
            border-radius: 2px;
            transition: var(--transition);
        }

        .tab.active {
            background-color: rgba(106, 13, 173, 0.15);
            color: var(--primary-light);
        }

        .tab.active::after {
            width: 80%;
        }

        .tab:hover:not(.active) {
            background-color: var(--card-dark);
        }

        .tab-content {
            display: none;
            background-color: var(--surface-dark);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            margin-bottom: 30px;
            animation: fadeIn 0.4s ease;
            border: 1px solid var(--border-dark);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .tab-content.active {
            display: block;
        }

        .sub-tabs {
            display: flex;
            margin-bottom: 25px;
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            overflow: hidden;
            flex-wrap: wrap;
            border: 1px solid var(--border-dark);
        }

        .sub-tab {
            padding: 15px 25px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            flex: 1;
            text-align: center;
            min-width: 140px;
        }

        .sub-tab.active {
            background: var(--gradient-primary);
            color: white;
        }

        .sub-tab:hover:not(.active) {
            background-color: rgba(106, 13, 173, 0.2);
        }

        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }

        .team-card {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--box-shadow);
            transition: var(--transition);
            cursor: pointer;
            border: 1px solid var(--border-dark);
            position: relative;
        }

        .team-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.35);
            border-color: var(--primary-light);
        }

        .team-icon {
            height: 140px;
            background: linear-gradient(45deg, var(--surface-dark), var(--card-dark));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            position: relative;
            overflow: hidden;
        }

        .team-icon img {
            max-width: 100%;
            max-height: 100%;
            object-fit: cover;
        }

        .team-info {
            padding: 20px;
        }

        .team-name {
            font-weight: 700;
            margin-bottom: 8px;
            color: var(--text-primary);
            font-size: 1.3rem;
        }

        .team-members-count {
            color: var(--text-secondary);
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--border-dark);
            border-radius: var(--border-radius);
            font-size: 1rem;
            background-color: var(--card-dark);
            color: var(--text-primary);
            transition: var(--transition);
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(106, 13, 173, 0.2);
        }

        button {
            background: var(--gradient-primary);
            color: white;
            border: none;
            padding: 14px 26px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 14px rgba(106, 13, 173, 0.4);
        }

        .btn-danger {
            background: linear-gradient(to right, var(--accent-color), var(--accent-light));
        }

        .btn-danger:hover {
            box-shadow: 0 6px 14px rgba(218, 112, 214, 0.4);
        }

        .btn-success {
            background: linear-gradient(to right, var(--secondary-color), var(--secondary-light));
        }

        .btn-success:hover {
            box-shadow: 0 6px 14px rgba(138, 43, 226, 0.4);
        }

        .btn-secondary {
            background: var(--card-dark);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background: var(--border-dark);
            box-shadow: 0 6px 14px rgba(0, 0, 0, 0.2);
        }

        .member-list {
            list-style: none;
            margin-top: 20px;
        }

        .member-item {
            padding: 15px;
            border-bottom: 1px solid var(--border-dark);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: var(--card-dark);
            margin-bottom: 10px;
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .member-item:hover {
            background-color: rgba(106, 13, 173, 0.1);
            transform: translateX(5px);
        }

        .note-editor {
            border: 2px solid var(--border-dark);
            border-radius: var(--border-radius);
            min-height: 250px;
            padding: 20px;
            margin-bottom: 20px;
            background-color: var(--card-dark);
            color: var(--text-primary);
            transition: var(--transition);
        }

        .note-editor:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .note-item {
            padding: 20px;
            border: 1px solid var(--border-dark);
            margin-bottom: 20px;
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .note-item:hover {
            border-color: var(--primary-light);
            transform: translateY(-2px);
        }

        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .note-author {
            font-weight: 600;
            color: var(--primary-light);
        }

        .note-date {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .competence-list,
        .council-list {
            margin-top: 25px;
        }

        .competence-item,
        .council-item {
            padding: 20px;
            border: 1px solid var(--border-dark);
            margin-bottom: 20px;
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: var(--transition);
        }

        .competence-item:hover,
        .council-item:hover {
            border-color: var(--primary-light);
            transform: translateY(-2px);
        }

        .competence-details {
            margin-top: 20px;
            padding: 20px;
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-dark);
        }

        .person-list {
            list-style: none;
            margin-top: 15px;
        }

        .person-item {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border-dark);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .person-item:last-child {
            border-bottom: none;
        }

        .task-list {
            margin-top: 20px;
        }

        .task-item {
            padding: 20px;
            border: 1px solid var(--border-dark);
            margin-bottom: 20px;
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            transition: var(--transition);
        }

        .task-item:hover {
            border-color: var(--primary-light);
            transform: translateY(-2px);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .task-title {
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--text-primary);
        }

        .task-assignee {
            color: var(--primary-light);
            font-weight: 500;
        }

        .task-description {
            margin-bottom: 15px;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .task-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .task-status {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-todo {
            background-color: rgba(218, 112, 214, 0.2);
            color: var(--accent-light);
        }

        .status-inprogress {
            background-color: rgba(255, 193, 7, 0.2);
            color: var(--warning-color);
        }

        .status-done {
            background-color: rgba(76, 175, 80, 0.2);
            color: var(--success-color);
        }

        .task-deadline {
            color: var(--text-secondary);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background-color: var(--surface-dark);
            padding: 30px;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--box-shadow);
            border: 1px solid var(--border-dark);
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-dark);
        }

        .modal-title {
            font-size: 1.6rem;
            color: var(--text-primary);
            font-weight: 700;
        }

        .close-modal {
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: var(--transition);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-modal:hover {
            color: var(--accent-light);
            background-color: rgba(218, 112, 214, 0.1);
        }

        .team-tab-content {
            display: none;
            padding: 20px 0;
            animation: fadeIn 0.4s ease;
        }

        .team-tab-content.active {
            display: block;
        }

        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .hidden {
            display: none;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .empty-state p {
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .icon-preview {
            width: 80px;
            height: 80px;
            border: 2px dashed var(--border-dark);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px auto;
            overflow: hidden;
        }

        .icon-preview img {
            max-width: 100%;
            max-height: 100%;
        }

        .section-title {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
            display: inline-block;
        }

        .card {
            background-color: var(--card-dark);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--box-shadow);
            border: 1px solid var(--border-dark);
        }

        .card-title {
            font-size: 1.3rem;
            color: var(--text-primary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .help-text {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-top: 5px;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(106, 13, 173, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @media (max-width: 768px) {
            .team-grid {
                grid-template-columns: 1fr;
            }

            .tabs,
            .sub-tabs {
                flex-direction: column;
            }

            .modal-content {
                padding: 20px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .task-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            .task-meta {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }

            header {
                flex-direction: column;
                gap: 15px;
                padding: 15px;
            }

            .user-info {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* Animation for notifications */
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: 500;
            z-index: 1001;
            animation: slideIn 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.success {
            background-color: var(--success-color);
        }

        .notification.error {
            background-color: var(--accent-color);
        }

        .notification.info {
            background-color: var(--primary-color);
        }
    </style>
</head>

<body>
    <header>
        <div class="logo">
            <i class="fas fa-users logo-icon"></i>
            <span>TeamOrganizer</span>
        </div>
        <div id="auth-container">
            <button id="login-btn" class="login-btn">
                <i class="fab fa-google"></i>
                <span>Zaloguj przez Google</span>
            </button>
            <div id="user-info" class="user-info hidden">
                <img id="user-avatar" class="user-avatar" src="" alt="Avatar">
                <span id="user-name" class="user-name"></span>
                <button id="logout-btn" class="btn-danger">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Wyloguj</span>
                </button>
            </div>
        </div>
    </header>

    <div class="container">
        <div id="loading-screen" class="loading hidden">
            <div class="loading-spinner"></div>
        </div>

        <div id="app-content" class="hidden">
            <div class="tabs">
                <div class="tab active" data-tab="teams">
                    <i class="fas fa-layer-group"></i>
                    <span>Podzespoy</span>
                </div>
                <div class="tab" data-tab="organization">
                    <i class="fas fa-users"></i>
                    <span>Zesp贸</span>
                </div>
            </div>

            <!-- Zakadka Podzespoy -->
            <div id="teams-tab" class="tab-content active">
                <h2 class="section-title">
                    <i class="fas fa-layer-group"></i>
                    Podzespoy
                </h2>
                <p>Zarzdzaj podzespoami lub utw贸rz nowy.</p>
                <button id="create-team-btn" class="btn-success">
                    <i class="fas fa-plus"></i>
                    Utw贸rz nowy podzesp贸
                </button>

                <div class="team-grid" id="teams-container">
                    <!-- Karty podzespo贸w bd dodawane dynamicznie -->
                </div>
            </div>

            <!-- Zakadka Zesp贸 -->
            <div id="organization-tab" class="tab-content">
                <div class="sub-tabs">
                    <div class="sub-tab active" data-subtab="councils">
                        <i class="fas fa-landmark"></i>
                        Rady i Organizacje
                    </div>
                    <div class="sub-tab" data-subtab="competences">
                        <i class="fas fa-tools"></i>
                        Kompetencje
                    </div>
                </div>

                <!-- Podzakadka Rady i Organizacje -->
                <div id="councils-subtab" class="team-tab-content active">
                    <h3 class="section-title">
                        <i class="fas fa-landmark"></i>
                        Rady i Organizacje
                    </h3>
                    <p>Dodaj i zarzdzaj radami oraz organizacjami zespou.</p>
                    <button id="add-council-btn" class="btn-success">
                        <i class="fas fa-plus"></i>
                        Dodaj organizacj/rad
                    </button>

                    <div id="councils-list" class="council-list">
                        <!-- Lista rad i organizacji bdzie dodawana dynamicznie -->
                    </div>
                </div>

                <!-- Podzakadka Kompetencje -->
                <div id="competences-subtab" class="team-tab-content">
                    <h3 class="section-title">
                        <i class="fas fa-tools"></i>
                        Kompetencje
                    </h3>
                    <p>Zarzdzaj kompetencjami czonk贸w zespou.</p>
                    <button id="add-competence-btn" class="btn-success">
                        <i class="fas fa-plus"></i>
                        Dodaj kompetencj
                    </button>

                    <div class="form-group">
                        <input type="text" id="competence-filter" placeholder="Filtruj kompetencje...">
                    </div>

                    <div id="competences-list" class="competence-list">
                        <!-- Lista kompetencji bdzie dodawana dynamicznie -->
                    </div>

                    <div id="competence-details" class="competence-details hidden">
                        <h4>Szczeg贸y kompetencji: <span id="competence-name"></span></h4>
                        <h5>Osoby z t kompetencj:</h5>
                        <ul id="competence-people-list" class="person-list">
                            <!-- Lista os贸b z kompetencj bdzie dodawana dynamicznie -->
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Modal do tworzenia podzespou -->
            <div id="create-team-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Utw贸rz nowy podzesp贸</h3>
                        <span class="close-modal">&times;</span>
                    </div>
                    <form id="create-team-form">
                        <div class="form-group">
                            <label for="team-name">Nazwa podzespou</label>
                            <input type="text" id="team-name" required placeholder="Wprowad藕 nazw podzespou">
                        </div>
                        <div class="form-group">
                            <label for="team-icon">Ikona podzespou</label>
                            <input type="file" id="team-icon" accept="image/*">
                            <div class="icon-preview" id="icon-preview">
                                <i class="fas fa-image"></i>
                            </div>
                            <div class="help-text">Dodaj ikon dla swojego podzespou (opcjonalnie)</div>
                        </div>
                        <div class="action-buttons">
                            <button type="submit">
                                <i class="fas fa-check"></i>
                                Utw贸rz
                            </button>
                            <button type="button" class="btn-danger close-modal">
                                <i class="fas fa-times"></i>
                                Anuluj
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal szczeg贸贸w podzespou -->
            <div id="team-details-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title" id="team-modal-title">Szczeg贸y podzespou</h3>
                        <span class="close-modal">&times;</span>
                    </div>

                    <div class="sub-tabs">
                        <div class="sub-tab active" data-team-tab="members">
                            <i class="fas fa-users"></i>
                            Czonkowie
                        </div>
                        <div class="sub-tab" data-team-tab="description">
                            <i class="fas fa-file-alt"></i>
                            Opis
                        </div>
                        <div class="sub-tab" data-team-tab="news">
                            <i class="fas fa-newspaper"></i>
                            Aktualnoci
                        </div>
                        <div class="sub-tab" data-team-tab="tasks">
                            <i class="fas fa-tasks"></i>
                            Zadania
                        </div>
                        <div class="sub-tab" data-team-tab="notes">
                            <i class="fas fa-sticky-note"></i>
                            Notatki
                        </div>
                        <div class="sub-tab" data-team-tab="import-export">
                            <i class="fas fa-file-export"></i>
                            Eksport/Import
                        </div>
                        <div class="sub-tab" data-team-tab="delete">
                            <i class="fas fa-trash"></i>
                            Usu
                        </div>
                    </div>

                    <!-- Zakadka Czonkowie -->
                    <div id="team-members-tab" class="team-tab-content active">
                        <h4 class="card-title">
                            <i class="fas fa-users"></i>
                            Czonkowie podzespou
                        </h4>
                        <p>Zarzdzaj czonkami podzespou.</p>
                        <button id="add-member-btn" class="btn-success">
                            <i class="fas fa-plus"></i>
                            Dodaj czonka
                        </button>

                        <ul class="member-list" id="team-members-list">
                            <!-- Lista czonk贸w bdzie dodawana dynamicznie -->
                        </ul>
                    </div>

                    <!-- Zakadka Opis -->
                    <div id="team-description-tab" class="team-tab-content">
                        <h4 class="card-title">
                            <i class="fas fa-file-alt"></i>
                            Opis podzespou
                        </h4>
                        <p>Dodaj opis podzespou i jego dziaa.</p>
                        <div class="note-editor" contenteditable="true" id="team-description-editor"></div>
                        <div class="action-buttons">
                            <button id="save-description-btn">
                                <i class="fas fa-save"></i>
                                Zapisz opis
                            </button>
                        </div>
                    </div>

                    <!-- Zakadka Aktualnoci -->
                    <div id="team-news-tab" class="team-tab-content">
                        <h4 class="card-title">
                            <i class="fas fa-newspaper"></i>
                            Aktualnoci podzespou
                        </h4>
                        <p>Dodaj najnowsze informacje i zmiany w podzespole.</p>
                        <div class="note-editor" contenteditable="true" id="team-news-editor"></div>
                        <div class="action-buttons">
                            <button id="save-news-btn">
                                <i class="fas fa-save"></i>
                                Zapisz aktualnoci
                            </button>
                        </div>
                    </div>

                    <!-- Zakadka Zadania -->
                    <div id="team-tasks-tab" class="team-tab-content">
                        <h4 class="card-title">
                            <i class="fas fa-tasks"></i>
                            Zadania podzespou
                        </h4>
                        <p>Dodaj i zarzdzaj zadaniami dla czonk贸w podzespou.</p>
                        <button id="add-task-btn" class="btn-success">
                            <i class="fas fa-plus"></i>
                            Dodaj zadanie
                        </button>

                        <div id="team-tasks-list" class="task-list">
                            <!-- Lista zada bdzie dodawana dynamicznie -->
                        </div>
                    </div>

                    <!-- Zakadka Notatki -->
                    <div id="team-notes-tab" class="team-tab-content">
                        <h4 class="card-title">
                            <i class="fas fa-sticky-note"></i>
                            Notatki ze spotka
                        </h4>
                        <p>Dodawaj i przegldaj notatki ze spotka podzespou.</p>
                        <button id="add-note-btn" class="btn-success">
                            <i class="fas fa-plus"></i>
                            Dodaj notatk
                        </button>

                        <div id="team-notes-list">
                            <!-- Lista notatek bdzie dodawana dynamicznie -->
                        </div>
                    </div>

                    <!-- Zakadka Eksport/Import -->
                    <div id="team-import-export-tab" class="team-tab-content">
                        <h4 class="card-title">
                            <i class="fas fa-file-export"></i>
                            Eksport/Import danych
                        </h4>
                        <p>Eksportuj lub importuj dane podzespou.</p>
                        <div class="action-buttons">
                            <button id="export-team-btn">
                                <i class="fas fa-download"></i>
                                Eksportuj dane podzespou
                            </button>
                            <button id="export-all-btn" class="btn-secondary">
                                <i class="fas fa-download"></i>
                                Eksportuj wszystkie dane
                            </button>
                        </div>

                        <div class="form-group">
                            <label for="import-team-file">Importuj dane podzespou</label>
                            <input type="file" id="import-team-file" accept=".json">
                            <div class="help-text">Wybierz plik JSON wyeksportowany wczeniej z aplikacji</div>
                        </div>
                        <div class="action-buttons">
                            <button id="import-team-btn">
                                <i class="fas fa-upload"></i>
                                Importuj
                            </button>
                        </div>
                    </div>

                    <!-- Zakadka Usu -->
                    <div id="team-delete-tab" class="team-tab-content">
                        <h4 class="card-title">
                            <i class="fas fa-trash"></i>
                            Usuwanie podzespou
                        </h4>
                        <p>Usunicie podzespou jest nieodwracalne. Wszystkie dane zwizane z tym podzespoem zostan trwale
                            usunite.</p>
                        <div class="action-buttons">
                            <button id="delete-team-btn" class="btn-danger">
                                <i class="fas fa-trash"></i>
                                Usu podzesp贸
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal dodawania czonka -->
            <div id="add-member-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Dodaj czonka</h3>
                        <span class="close-modal">&times;</span>
                    </div>
                    <form id="add-member-form">
                        <div class="form-group">
                            <label for="member-name">Imi i nazwisko</label>
                            <input type="text" id="member-name" required placeholder="Wprowad藕 imi i nazwisko">
                        </div>
                        <div class="action-buttons">
                            <button type="submit">
                                <i class="fas fa-check"></i>
                                Dodaj
                            </button>
                            <button type="button" class="btn-danger close-modal">
                                <i class="fas fa-times"></i>
                                Anuluj
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal dodawania notatki -->
            <div id="add-note-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Dodaj notatk</h3>
                        <span class="close-modal">&times;</span>
                    </div>
                    <form id="add-note-form">
                        <div class="form-group">
                            <label for="note-author">Autor</label>
                            <input type="text" id="note-author" required value="Jan Kowalski">
                        </div>
                        <div class="form-group">
                            <label for="note-date">Data</label>
                            <input type="date" id="note-date" required>
                        </div>
                        <div class="form-group">
                            <label for="note-content">Tre notatki</label>
                            <textarea id="note-content" rows="5" required placeholder="Wprowad藕 tre notatki"></textarea>
                        </div>
                        <div class="action-buttons">
                            <button type="submit">
                                <i class="fas fa-check"></i>
                                Dodaj
                            </button>
                            <button type="button" class="btn-danger close-modal">
                                <i class="fas fa-times"></i>
                                Anuluj
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal dodawania zadania -->
            <div id="add-task-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Dodaj zadanie</h3>
                        <span class="close-modal">&times;</span>
                    </div>
                    <form id="add-task-form">
                        <div class="form-group">
                            <label for="task-title">Tytu zadania</label>
                            <input type="text" id="task-title" required placeholder="Wprowad藕 tytu zadania">
                        </div>
                        <div class="form-group">
                            <label for="task-description">Opis zadania</label>
                            <textarea id="task-description" rows="3" required
                                placeholder="Wprowad藕 opis zadania"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="task-assignee">Przypisz do</label>
                            <select id="task-assignee" required>
                                <option value="">Wybierz czonka</option>
                                <!-- Opcje bd dodawane dynamicznie -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="task-status">Status</label>
                            <select id="task-status" required>
                                <option value="todo">Do wykonania</option>
                                <option value="inprogress">W trakcie</option>
                                <option value="done">Zakoczone</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="task-deadline">Termin</label>
                            <input type="date" id="task-deadline" required>
                        </div>
                        <div class="action-buttons">
                            <button type="submit">
                                <i class="fas fa-check"></i>
                                Dodaj
                            </button>
                            <button type="button" class="btn-danger close-modal">
                                <i class="fas fa-times"></i>
                                Anuluj
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal edycji zadania -->
            <div id="edit-task-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Edytuj zadanie</h3>
                        <span class="close-modal">&times;</span>
                    </div>
                    <form id="edit-task-form">
                        <input type="hidden" id="edit-task-id">
                        <div class="form-group">
                            <label for="edit-task-title">Tytu zadania</label>
                            <input type="text" id="edit-task-title" required placeholder="Wprowad藕 tytu zadania">
                        </div>
                        <div class="form-group">
                            <label for="edit-task-description">Opis zadania</label>
                            <textarea id="edit-task-description" rows="3" required
                                placeholder="Wprowad藕 opis zadania"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="edit-task-assignee">Przypisz do</label>
                            <select id="edit-task-assignee" required>
                                <option value="">Wybierz czonka</option>
                                <!-- Opcje bd dodawane dynamicznie -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-task-status">Status</label>
                            <select id="edit-task-status" required>
                                <option value="todo">Do wykonania</option>
                                <option value="inprogress">W trakcie</option>
                                <option value="done">Zakoczone</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-task-deadline">Termin</label>
                            <input type="date" id="edit-task-deadline" required>
                        </div>
                        <div class="action-buttons">
                            <button type="submit">
                                <i class="fas fa-save"></i>
                                Zapisz zmiany
                            </button>
                            <button type="button" class="btn-danger close-modal">
                                <i class="fas fa-times"></i>
                                Anuluj
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal dodawania rady/organizacji -->
            <div id="add-council-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Dodaj organizacj/rad</h3>
                        <span class="close-modal">&times;</span>
                    </div>
                    <form id="add-council-form">
                        <div class="form-group">
                            <label for="council-name">Nazwa</label>
                            <input type="text" id="council-name" required placeholder="Wprowad藕 nazw">
                        </div>
                        <div class="form-group">
                            <label for="council-description">Opis</label>
                            <textarea id="council-description" rows="3" required
                                placeholder="Wprowad藕 kr贸tki opis"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="council-contact">Osoba kontaktowa</label>
                            <select id="council-contact" required>
                                <option value="">Wybierz osob kontaktow</option>
                                <!-- Opcje bd dodawane dynamicznie -->
                            </select>
                        </div>
                        <div class="action-buttons">
                            <button type="submit">
                                <i class="fas fa-check"></i>
                                Dodaj
                            </button>
                            <button type="button" class="btn-danger close-modal">
                                <i class="fas fa-times"></i>
                                Anuluj
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Modal dodawania kompetencji -->
            <div id="add-competence-modal" class="modal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">Dodaj kompetencj</h3>
                        <span class="close-modal">&times;</span>
                    </div>
                    <form id="add-competence-form">
                        <div class="form-group">
                            <label for="competence-name">Nazwa kompetencji</label>
                            <input type="text" id="competence-name" required placeholder="Wprowad藕 nazw kompetencji">
                        </div>
                        <div class="form-group">
                            <label for="competence-people">Osoby z t kompetencj</label>
                            <select id="competence-people" multiple>
                                <!-- Opcje bd dodawane dynamicznie -->
                            </select>
                            <div class="help-text">Przytrzymaj Ctrl (Cmd na Mac) aby wybra wiele os贸b</div>
                        </div>
                        <div class="action-buttons">
                            <button type="submit">
                                <i class="fas fa-check"></i>
                                Dodaj
                            </button>
                            <button type="button" class="btn-danger close-modal">
                                <i class="fas fa-times"></i>
                                Anuluj
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Konfiguracja Firebase - nale偶y zastpi wasnymi danymi z konsoli Firebase
        const firebaseConfig = {
              apiKey: "AIzaSyCrXDdr4iRmDM2ahdbdV3VMvPBShKiNFVU",
              authDomain: "strona-podzespolow.firebaseapp.com",
              projectId: "strona-podzespolow",
              storageBucket: "strona-podzespolow.firebasestorage.app",
              messagingSenderId: "55919562527",
              appId: "1:55919562527:web:0c93ea9f3bb390feaa6a2a"
        };

        // Inicjalizacja Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Dane aplikacji
        let currentUser = null;
        let teams = [];
        let councils = [];
        let competences = [];
        let currentTeam = null;
        let currentCompetence = null;

        // Elementy DOM
        const loginBtn = document.getElementById('login-btn');
        const logoutBtn = document.getElementById('logout-btn');
        const userInfo = document.getElementById('user-info');
        const userName = document.getElementById('user-name');
        const userAvatar = document.getElementById('user-avatar');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const subTabs = document.querySelectorAll('.sub-tab');
        const createTeamBtn = document.getElementById('create-team-btn');
        const createTeamModal = document.getElementById('create-team-modal');
        const teamDetailsModal = document.getElementById('team-details-modal');
        const addMemberModal = document.getElementById('add-member-modal');
        const addNoteModal = document.getElementById('add-note-modal');
        const addTaskModal = document.getElementById('add-task-modal');
        const editTaskModal = document.getElementById('edit-task-modal');
        const addCouncilModal = document.getElementById('add-council-modal');
        const addCompetenceModal = document.getElementById('add-competence-modal');
        const closeModals = document.querySelectorAll('.close-modal');
        const createTeamForm = document.getElementById('create-team-form');
        const addMemberForm = document.getElementById('add-member-form');
        const addNoteForm = document.getElementById('add-note-form');
        const addTaskForm = document.getElementById('add-task-form');
        const editTaskForm = document.getElementById('edit-task-form');
        const addCouncilForm = document.getElementById('add-council-form');
        const addCompetenceForm = document.getElementById('add-competence-form');
        const teamsContainer = document.getElementById('teams-container');
        const addCouncilBtn = document.getElementById('add-council-btn');
        const addCompetenceBtn = document.getElementById('add-competence-btn');
        const councilsList = document.getElementById('councils-list');
        const competencesList = document.getElementById('competences-list');
        const competenceFilter = document.getElementById('competence-filter');
        const competenceDetails = document.getElementById('competence-details');
        const competenceName = document.getElementById('competence-name');
        const competencePeopleList = document.getElementById('competence-people-list');
        const teamTabs = document.querySelectorAll('[data-team-tab]');
        const teamTabContents = document.querySelectorAll('.team-tab-content');
        const iconPreview = document.getElementById('icon-preview');
        const teamIconInput = document.getElementById('team-icon');
        const exportAllBtn = document.getElementById('export-all-btn');
        const loadingScreen = document.getElementById('loading-screen');
        const appContent = document.getElementById('app-content');

        // Inicjalizacja aplikacji
        function initApp() {
            // Sprawdzenie stanu uwierzytelnienia
            auth.onAuthStateChanged(user => {
                if (user) {
                    // U偶ytkownik jest zalogowany
                    currentUser = user;
                    updateUIAfterAuth();
                    loadUserData();
                } else {
                    // U偶ytkownik nie jest zalogowany
                    currentUser = null;
                    updateUIAfterAuth();
                    hideLoading();
                }
            });

            // Obsuga logowania przez Google
            loginBtn.addEventListener('click', signInWithGoogle);
            logoutBtn.addEventListener('click', signOut);

            // Obsuga zakadek
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabId = tab.getAttribute('data-tab');
                    activateTab(tabId);
                });
            });

            // Obsuga podzakadek
            subTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const subtabId = tab.getAttribute('data-subtab');
                    activateSubTab(subtabId);
                });
            });

            // Obsuga zakadek w modalach
            teamTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const teamTabId = tab.getAttribute('data-team-tab');
                    activateTeamTab(teamTabId);
                });
            });

            // Obsuga modali
            createTeamBtn.addEventListener('click', () => {
                createTeamModal.style.display = 'flex';
            });

            closeModals.forEach(closeBtn => {
                closeBtn.addEventListener('click', () => {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.style.display = 'none';
                    });
                });
            });

            // Podgld ikony
            teamIconInput.addEventListener('change', handleIconPreview);

            // Obsuga formularzy
            createTeamForm.addEventListener('submit', handleCreateTeam);
            addMemberForm.addEventListener('submit', handleAddMember);
            addNoteForm.addEventListener('submit', handleAddNote);
            addTaskForm.addEventListener('submit', handleAddTask);
            editTaskForm.addEventListener('submit', handleEditTask);
            addCouncilForm.addEventListener('submit', handleAddCouncil);
            addCompetenceForm.addEventListener('submit', handleAddCompetence);

            // Obsuga przycisk贸w
            addCouncilBtn.addEventListener('click', () => {
                // Wypenij list os贸b
                const contactSelect = document.getElementById('council-contact');
                contactSelect.innerHTML = '<option value="">Wybierz osob kontaktow</option>';

                const allMembers = getAllUniqueMembers();
                allMembers.forEach(member => {
                    const option = document.createElement('option');
                    option.value = member;
                    option.textContent = member;
                    contactSelect.appendChild(option);
                });

                addCouncilModal.style.display = 'flex';
            });

            addCompetenceBtn.addEventListener('click', () => {
                // Wypenij list os贸b
                const peopleSelect = document.getElementById('competence-people');
                peopleSelect.innerHTML = '';

                const allMembers = getAllUniqueMembers();
                allMembers.forEach(member => {
                    const option = document.createElement('option');
                    option.value = member;
                    option.textContent = member;
                    peopleSelect.appendChild(option);
                });

                addCompetenceModal.style.display = 'flex';
            });

            document.getElementById('add-member-btn').addEventListener('click', () => {
                addMemberModal.style.display = 'flex';
            });

            document.getElementById('add-note-btn').addEventListener('click', () => {
                // Ustaw domyln dat na dzisiejsz
                document.getElementById('note-date').valueAsDate = new Date();
                addNoteModal.style.display = 'flex';
            });

            document.getElementById('add-task-btn').addEventListener('click', () => {
                // Ustaw domyln dat na dzisiejsz + 7 dni
                const nextWeek = new Date();
                nextWeek.setDate(nextWeek.getDate() + 7);
                document.getElementById('task-deadline').valueAsDate = nextWeek;

                // Wypenij list czonk贸w
                const assigneeSelect = document.getElementById('task-assignee');
                assigneeSelect.innerHTML = '<option value="">Wybierz czonka</option>';

                if (currentTeam && currentTeam.members) {
                    currentTeam.members.forEach(member => {
                        const option = document.createElement('option');
                        option.value = member.id;
                        option.textContent = member.name;
                        assigneeSelect.appendChild(option);
                    });
                }

                addTaskModal.style.display = 'flex';
            });

            document.getElementById('delete-team-btn').addEventListener('click', handleDeleteTeam);
            document.getElementById('save-description-btn').addEventListener('click', handleSaveDescription);
            document.getElementById('save-news-btn').addEventListener('click', handleSaveNews);
            document.getElementById('export-team-btn').addEventListener('click', handleExportTeam);
            exportAllBtn.addEventListener('click', handleExportAll);
            document.getElementById('import-team-btn').addEventListener('click', handleImportTeam);

            // Obsuga filtrowania kompetencji
            competenceFilter.addEventListener('input', filterCompetences);

            // Ustawienie domylnej daty dla notatek
            document.getElementById('note-date').valueAsDate = new Date();
        }

        // Funkcje logowania Firebase
        function signInWithGoogle() {
            showLoading();
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider)
                .then((result) => {
                    showNotification('Zalogowano pomylnie!', 'success');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd logowania: ' + error.message, 'error');
                });
        }

        function signOut() {
            showLoading();
            auth.signOut()
                .then(() => {
                    showNotification('Wylogowano pomylnie!', 'info');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd wylogowywania: ' + error.message, 'error');
                });
        }

        function updateUIAfterAuth() {
            if (currentUser) {
                loginBtn.classList.add('hidden');
                userInfo.classList.remove('hidden');
                userName.textContent = currentUser.displayName;
                userAvatar.src = currentUser.photoURL;
                document.getElementById('note-author').value = currentUser.displayName;
                appContent.classList.remove('hidden');
            } else {
                loginBtn.classList.remove('hidden');
                userInfo.classList.add('hidden');
                appContent.classList.add('hidden');
            }
        }

        // Funkcje zarzdzania danymi u偶ytkownika
        function loadUserData() {
            showLoading();
            
            // Pobieranie zespo贸w
            db.collection('users').doc(currentUser.uid).collection('teams')
                .get()
                .then((querySnapshot) => {
                    teams = [];
                    querySnapshot.forEach((doc) => {
                        teams.push({ id: doc.id, ...doc.data() });
                    });
                    
                    // Pobieranie rad i organizacji
                    return db.collection('users').doc(currentUser.uid).collection('councils').get();
                })
                .then((querySnapshot) => {
                    councils = [];
                    querySnapshot.forEach((doc) => {
                        councils.push({ id: doc.id, ...doc.data() });
                    });
                    
                    // Pobieranie kompetencji
                    return db.collection('users').doc(currentUser.uid).collection('competences').get();
                })
                .then((querySnapshot) => {
                    competences = [];
                    querySnapshot.forEach((doc) => {
                        competences.push({ id: doc.id, ...doc.data() });
                    });
                    
                    // Renderowanie danych
                    renderTeams();
                    renderCouncils();
                    renderCompetences();
                    hideLoading();
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd adowania danych: ' + error.message, 'error');
                });
        }

        function saveTeam(team) {
            if (team.id) {
                // Aktualizacja istniejcego zespou
                const teamData = { ...team };
                delete teamData.id; // Firestore nie lubi gdy wysyamy id w danych
                
                return db.collection('users').doc(currentUser.uid).collection('teams')
                    .doc(team.id)
                    .update(teamData);
            } else {
                // Tworzenie nowego zespou
                return db.collection('users').doc(currentUser.uid).collection('teams')
                    .add(team)
                    .then((docRef) => {
                        team.id = docRef.id;
                        return docRef;
                    });
            }
        }

        function deleteTeam(teamId) {
            return db.collection('users').doc(currentUser.uid).collection('teams')
                .doc(teamId)
                .delete();
        }

        function saveCouncil(council) {
            if (council.id) {
                const councilData = { ...council };
                delete councilData.id;
                
                return db.collection('users').doc(currentUser.uid).collection('councils')
                    .doc(council.id)
                    .update(councilData);
            } else {
                return db.collection('users').doc(currentUser.uid).collection('councils')
                    .add(council)
                    .then((docRef) => {
                        council.id = docRef.id;
                        return docRef;
                    });
            }
        }

        function deleteCouncil(councilId) {
            return db.collection('users').doc(currentUser.uid).collection('councils')
                .doc(councilId)
                .delete();
        }

        function saveCompetence(competence) {
            if (competence.id) {
                const competenceData = { ...competence };
                delete competenceData.id;
                
                return db.collection('users').doc(currentUser.uid).collection('competences')
                    .doc(competence.id)
                    .update(competenceData);
            } else {
                return db.collection('users').doc(currentUser.uid).collection('competences')
                    .add(competence)
                    .then((docRef) => {
                        competence.id = docRef.id;
                        return docRef;
                    });
            }
        }

        function deleteCompetence(competenceId) {
            return db.collection('users').doc(currentUser.uid).collection('competences')
                .doc(competenceId)
                .delete();
        }

        // Funkcje zarzdzania zakadkami
        function activateTab(tabId) {
            tabs.forEach(tab => {
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            tabContents.forEach(content => {
                if (content.id === `${tabId}-tab`) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
        }

        function activateSubTab(subtabId) {
            subTabs.forEach(tab => {
                if (tab.getAttribute('data-subtab') === subtabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            document.querySelectorAll('.team-tab-content').forEach(content => {
                content.classList.remove('active');
            });

            document.getElementById(`${subtabId}-subtab`).classList.add('active');
        }

        function activateTeamTab(teamTabId) {
            teamTabs.forEach(tab => {
                if (tab.getAttribute('data-team-tab') === teamTabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            teamTabContents.forEach(content => {
                content.classList.remove('active');
            });

            document.getElementById(`team-${teamTabId}-tab`).classList.add('active');
        }

        // Funkcje zarzdzania podzespoami
        function handleIconPreview(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    iconPreview.innerHTML = `<img src="${e.target.result}" alt="Podgld ikony">`;
                };
                reader.readAsDataURL(file);
            }
        }

        function handleCreateTeam(e) {
            e.preventDefault();
            showLoading();
            
            const teamName = document.getElementById('team-name').value;
            const teamIconFile = document.getElementById('team-icon').files[0];

            let teamIcon = ""; // Domylna ikona

            if (teamIconFile) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    teamIcon = e.target.result;
                    finishTeamCreation(teamName, teamIcon);
                };
                reader.readAsDataURL(teamIconFile);
            } else {
                finishTeamCreation(teamName, teamIcon);
            }
        }

        function finishTeamCreation(teamName, teamIcon) {
            const newTeam = {
                name: teamName,
                icon: teamIcon,
                members: [],
                description: "",
                news: "",
                tasks: [],
                notes: []
            };

            saveTeam(newTeam)
                .then(() => {
                    teams.push(newTeam);
                    renderTeams();
                    createTeamModal.style.display = 'none';
                    createTeamForm.reset();
                    iconPreview.innerHTML = '<i class="fas fa-image"></i>';
                    hideLoading();
                    showNotification(`Podzesp贸 "${teamName}" zosta utworzony!`, 'success');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd tworzenia podzespou: ' + error.message, 'error');
                });
        }

        function openTeamDetails(teamId) {
            currentTeam = teams.find(team => team.id === teamId);
            if (currentTeam) {
                document.getElementById('team-modal-title').textContent = currentTeam.name;
                renderTeamDetails();
                teamDetailsModal.style.display = 'flex';

                // Aktywuj pierwsz zakadk
                activateTeamTab('members');
            }
        }

        function renderTeams() {
            teamsContainer.innerHTML = '';

            if (teams.length === 0) {
                teamsContainer.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-layer-group"></i>
                        <p>Brak utworzonych podzespo贸w. Kliknij "Utw贸rz nowy podzesp贸", aby doda pierwszy.</p>
                    </div>
                `;
                return;
            }

            teams.forEach(team => {
                const teamCard = document.createElement('div');
                teamCard.className = 'team-card';

                let iconContent = '';
                if (team.icon.startsWith('data:image')) {
                    iconContent = `<img src="${team.icon}" alt="${team.name}">`;
                } else {
                    iconContent = `<span>${team.icon}</span>`;
                }

                teamCard.innerHTML = `
                    <div class="team-icon">${iconContent}</div>
                    <div class="team-info">
                        <div class="team-name">${team.name}</div>
                        <div class="team-members-count">
                            <i class="fas fa-users"></i>
                            ${team.members.length} czonk贸w
                        </div>
                    </div>
                `;

                teamCard.addEventListener('click', () => openTeamDetails(team.id));
                teamsContainer.appendChild(teamCard);
            });
        }

        function renderTeamDetails() {
            if (!currentTeam) return;

            // Renderowanie czonk贸w
            const membersList = document.getElementById('team-members-list');
            membersList.innerHTML = '';

            if (currentTeam.members.length === 0) {
                membersList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-users"></i>
                        <p>Brak czonk贸w w tym podzespole.</p>
                    </div>
                `;
            } else {
                currentTeam.members.sort((a, b) => a.name.localeCompare(b.name)).forEach(member => {
                    const memberItem = document.createElement('li');
                    memberItem.className = 'member-item';
                    memberItem.innerHTML = `
                        <span>${member.name}</span>
                        <button class="btn-danger remove-member" data-id="${member.id}">
                            <i class="fas fa-trash"></i>
                            Usu
                        </button>
                    `;
                    membersList.appendChild(memberItem);
                });

                // Dodanie nasuchiwania na przyciski usuwania
                document.querySelectorAll('.remove-member').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const memberId = e.target.closest('.remove-member').getAttribute('data-id');
                        removeMember(memberId);
                    });
                });
            }

            // Renderowanie opisu
            const descriptionEditor = document.getElementById('team-description-editor');
            descriptionEditor.innerHTML = currentTeam.description || '<p>Dodaj opis podzespou...</p>';

            // Renderowanie aktualnoci
            const newsEditor = document.getElementById('team-news-editor');
            newsEditor.innerHTML = currentTeam.news || '<p>Dodaj aktualnoci podzespou...</p>';

            // Renderowanie zada
            const tasksList = document.getElementById('team-tasks-list');
            tasksList.innerHTML = '';

            if (currentTeam.tasks.length === 0) {
                tasksList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-tasks"></i>
                        <p>Brak zada w tym podzespole.</p>
                    </div>
                `;
            } else {
                currentTeam.tasks.sort((a, b) => new Date(a.deadline) - new Date(b.deadline)).forEach(task => {
                    const taskItem = document.createElement('div');
                    taskItem.className = 'task-item';
                    taskItem.setAttribute('data-id', task.id);

                    let statusClass = '';
                    let statusText = '';
                    let statusIcon = '';

                    switch (task.status) {
                        case 'todo':
                            statusClass = 'status-todo';
                            statusText = 'Do wykonania';
                            statusIcon = 'fas fa-circle';
                            break;
                        case 'inprogress':
                            statusClass = 'status-inprogress';
                            statusText = 'W trakcie';
                            statusIcon = 'fas fa-spinner';
                            break;
                        case 'done':
                            statusClass = 'status-done';
                            statusText = 'Zakoczone';
                            statusIcon = 'fas fa-check-circle';
                            break;
                    }

                    const assignee = currentTeam.members.find(m => m.id === task.assignee) || { name: 'Nieznany' };

                    taskItem.innerHTML = `
                        <div class="task-header">
                            <div class="task-title">${task.title}</div>
                            <div class="task-assignee">Przypisane do: ${assignee.name}</div>
                        </div>
                        <div class="task-description">${task.description}</div>
                        <div class="task-meta">
                            <span class="task-status ${statusClass}">
                                <i class="${statusIcon}"></i>
                                ${statusText}
                            </span>
                            <span class="task-deadline">
                                <i class="fas fa-calendar-alt"></i>
                                Termin: ${formatDate(task.deadline)}
                            </span>
                        </div>
                        <div class="action-buttons">
                            <button class="edit-task" data-id="${task.id}">
                                <i class="fas fa-edit"></i>
                                Edytuj
                            </button>
                            <button class="btn-danger remove-task" data-id="${task.id}">
                                <i class="fas fa-trash"></i>
                                Usu
                            </button>
                        </div>
                    `;
                    tasksList.appendChild(taskItem);
                });

                // Dodanie nasuchiwania na przyciski zada
                document.querySelectorAll('.edit-task').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const taskId = e.target.closest('.edit-task').getAttribute('data-id');
                        editTask(taskId);
                    });
                });

                document.querySelectorAll('.remove-task').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const taskId = e.target.closest('.remove-task').getAttribute('data-id');
                        removeTask(taskId);
                    });
                });
            }

            // Renderowanie notatek
            const notesList = document.getElementById('team-notes-list');
            notesList.innerHTML = '';

            if (currentTeam.notes.length === 0) {
                notesList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-sticky-note"></i>
                        <p>Brak notatek w tym podzespole.</p>
                    </div>
                `;
            } else {
                currentTeam.notes.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach(note => {
                    const noteItem = document.createElement('div');
                    noteItem.className = 'note-item';
                    noteItem.innerHTML = `
                        <div class="note-header">
                            <span class="note-author">${note.author}</span>
                            <span class="note-date">${formatDate(note.date)}</span>
                        </div>
                        <div class="note-content">${note.content}</div>
                    `;
                    notesList.appendChild(noteItem);
                });
            }
        }

        function handleAddMember(e) {
            e.preventDefault();
            if (!currentTeam) return;

            showLoading();
            
            const memberName = document.getElementById('member-name').value;

            const newMember = {
                id: Date.now().toString(),
                name: memberName
            };

            currentTeam.members.push(newMember);
            
            saveTeam(currentTeam)
                .then(() => {
                    renderTeamDetails();
                    addMemberModal.style.display = 'none';
                    addMemberForm.reset();
                    hideLoading();
                    showNotification(`Czonek "${memberName}" zosta dodany do podzespou!`, 'success');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd dodawania czonka: ' + error.message, 'error');
                });
        }

        function removeMember(memberId) {
            if (!currentTeam) return;

            if (confirm('Czy na pewno chcesz usun tego czonka z podzespou?')) {
                showLoading();
                
                currentTeam.members = currentTeam.members.filter(member => member.id !== memberId);
                
                saveTeam(currentTeam)
                    .then(() => {
                        renderTeamDetails();
                        hideLoading();
                        showNotification('Czonek zosta usunity z podzespou!', 'success');
                    })
                    .catch((error) => {
                        hideLoading();
                        showNotification('Bd usuwania czonka: ' + error.message, 'error');
                    });
            }
        }

        function handleAddNote(e) {
            e.preventDefault();
            if (!currentTeam) return;

            showLoading();
            
            const noteAuthor = document.getElementById('note-author').value;
            const noteDate = document.getElementById('note-date').value;
            const noteContent = document.getElementById('note-content').value;

            const newNote = {
                id: Date.now().toString(),
                date: noteDate,
                author: noteAuthor,
                content: noteContent
            };

            currentTeam.notes.push(newNote);
            
            saveTeam(currentTeam)
                .then(() => {
                    renderTeamDetails();
                    addNoteModal.style.display = 'none';
                    addNoteForm.reset();
                    document.getElementById('note-author').value = currentUser ? currentUser.displayName : '';
                    hideLoading();
                    showNotification('Notatka zostaa dodana!', 'success');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd dodawania notatki: ' + error.message, 'error');
                });
        }

        function handleAddTask(e) {
            e.preventDefault();
            if (!currentTeam) return;

            showLoading();
            
            const taskTitle = document.getElementById('task-title').value;
            const taskDescription = document.getElementById('task-description').value;
            const taskAssignee = document.getElementById('task-assignee').value;
            const taskStatus = document.getElementById('task-status').value;
            const taskDeadline = document.getElementById('task-deadline').value;

            const newTask = {
                id: Date.now().toString(),
                title: taskTitle,
                description: taskDescription,
                assignee: taskAssignee,
                status: taskStatus,
                deadline: taskDeadline
            };

            currentTeam.tasks.push(newTask);
            
            saveTeam(currentTeam)
                .then(() => {
                    renderTeamDetails();
                    addTaskModal.style.display = 'none';
                    addTaskForm.reset();
                    hideLoading();
                    showNotification(`Zadanie "${taskTitle}" zostao dodane!`, 'success');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd dodawania zadania: ' + error.message, 'error');
                });
        }

        function editTask(taskId) {
            if (!currentTeam) return;

            const task = currentTeam.tasks.find(t => t.id === taskId);
            if (task) {
                document.getElementById('edit-task-id').value = task.id;
                document.getElementById('edit-task-title').value = task.title;
                document.getElementById('edit-task-description').value = task.description;
                document.getElementById('edit-task-status').value = task.status;
                document.getElementById('edit-task-deadline').value = task.deadline;

                // Wypenij list czonk贸w
                const assigneeSelect = document.getElementById('edit-task-assignee');
                assigneeSelect.innerHTML = '<option value="">Wybierz czonka</option>';

                if (currentTeam.members) {
                    currentTeam.members.forEach(member => {
                        const option = document.createElement('option');
                        option.value = member.id;
                        option.textContent = member.name;
                        option.selected = (member.id === task.assignee);
                        assigneeSelect.appendChild(option);
                    });
                }

                editTaskModal.style.display = 'flex';
            }
        }

        function handleEditTask(e) {
            e.preventDefault();
            if (!currentTeam) return;

            showLoading();
            
            const taskId = document.getElementById('edit-task-id').value;
            const taskTitle = document.getElementById('edit-task-title').value;
            const taskDescription = document.getElementById('edit-task-description').value;
            const taskAssignee = document.getElementById('edit-task-assignee').value;
            const taskStatus = document.getElementById('edit-task-status').value;
            const taskDeadline = document.getElementById('edit-task-deadline').value;

            const taskIndex = currentTeam.tasks.findIndex(t => t.id === taskId);
            if (taskIndex !== -1) {
                currentTeam.tasks[taskIndex] = {
                    id: taskId,
                    title: taskTitle,
                    description: taskDescription,
                    assignee: taskAssignee,
                    status: taskStatus,
                    deadline: taskDeadline
                };

                saveTeam(currentTeam)
                    .then(() => {
                        renderTeamDetails();
                        editTaskModal.style.display = 'none';
                        hideLoading();
                        showNotification(`Zadanie "${taskTitle}" zostao zaktualizowane!`, 'success');
                    })
                    .catch((error) => {
                        hideLoading();
                        showNotification('Bd edycji zadania: ' + error.message, 'error');
                    });
            }
        }

        function removeTask(taskId) {
            if (!currentTeam) return;

            if (confirm('Czy na pewno chcesz usun to zadanie?')) {
                showLoading();
                
                currentTeam.tasks = currentTeam.tasks.filter(task => task.id !== taskId);
                
                saveTeam(currentTeam)
                    .then(() => {
                        renderTeamDetails();
                        hideLoading();
                        showNotification('Zadanie zostao usunite!', 'success');
                    })
                    .catch((error) => {
                        hideLoading();
                        showNotification('Bd usuwania zadania: ' + error.message, 'error');
                    });
            }
        }

        function handleSaveDescription() {
            if (!currentTeam) return;

            showLoading();
            
            const descriptionEditor = document.getElementById('team-description-editor');
            currentTeam.description = descriptionEditor.innerHTML;
            
            saveTeam(currentTeam)
                .then(() => {
                    hideLoading();
                    showNotification('Opis podzespou zosta zapisany!', 'success');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd zapisywania opisu: ' + error.message, 'error');
                });
        }

        function handleSaveNews() {
            if (!currentTeam) return;

            showLoading();
            
            const newsEditor = document.getElementById('team-news-editor');
            currentTeam.news = newsEditor.innerHTML;
            
            saveTeam(currentTeam)
                .then(() => {
                    hideLoading();
                    showNotification('Aktualnoci podzespou zostay zapisane!', 'success');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd zapisywania aktualnoci: ' + error.message, 'error');
                });
        }

        function handleDeleteTeam() {
            if (!currentTeam) return;

            if (confirm(`Czy na pewno chcesz usun podzesp贸 "${currentTeam.name}"? Tej operacji nie mo偶na cofn.`)) {
                showLoading();
                
                deleteTeam(currentTeam.id)
                    .then(() => {
                        teams = teams.filter(team => team.id !== currentTeam.id);
                        teamDetailsModal.style.display = 'none';
                        renderTeams();
                        hideLoading();
                        showNotification(`Podzesp贸 "${currentTeam.name}" zosta usunity!`, 'success');
                    })
                    .catch((error) => {
                        hideLoading();
                        showNotification('Bd usuwania podzespou: ' + error.message, 'error');
                    });
            }
        }

        // Funkcje zarzdzania radami i kompetencjami
        function handleAddCouncil(e) {
            e.preventDefault();
            showLoading();

            const councilName = document.getElementById('council-name').value;
            const councilDescription = document.getElementById('council-description').value;
            const councilContact = document.getElementById('council-contact').value;

            const newCouncil = {
                name: councilName,
                description: councilDescription,
                contact: councilContact
            };

            saveCouncil(newCouncil)
                .then(() => {
                    councils.push(newCouncil);
                    renderCouncils();
                    addCouncilModal.style.display = 'none';
                    addCouncilForm.reset();
                    hideLoading();
                    showNotification(`Rada/Organizacja "${councilName}" zostaa dodana!`, 'success');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd dodawania rady/organizacji: ' + error.message, 'error');
                });
        }

        function handleAddCompetence(e) {
            e.preventDefault();
            showLoading();

            const competenceNameValue = document.getElementById('competence-name').value;
            const competencePeopleSelect = document.getElementById('competence-people');
            const selectedPeople = Array.from(competencePeopleSelect.selectedOptions).map(option => option.value);

            const newCompetence = {
                name: competenceNameValue,
                people: selectedPeople
            };

            saveCompetence(newCompetence)
                .then(() => {
                    competences.push(newCompetence);
                    renderCompetences();
                    addCompetenceModal.style.display = 'none';
                    addCompetenceForm.reset();
                    hideLoading();
                    showNotification(`Kompetencja "${competenceNameValue}" zostaa dodana!`, 'success');
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('Bd dodawania kompetencji: ' + error.message, 'error');
                });
        }

        function getAllUniqueMembers() {
            const allMembers = new Set();
            teams.forEach(team => {
                team.members.forEach(member => {
                    allMembers.add(member.name);
                });
            });
            return Array.from(allMembers).sort();
        }

        function renderCouncils() {
            councilsList.innerHTML = '';

            if (councils.length === 0) {
                councilsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-landmark"></i>
                        <p>Brak dodanych rad i organizacji.</p>
                    </div>
                `;
                return;
            }

            councils.forEach(council => {
                const councilItem = document.createElement('div');
                councilItem.className = 'council-item';
                councilItem.innerHTML = `
                    <div>
                        <h4>${council.name}</h4>
                        <p>${council.description}</p>
                        <p><strong>Kontakt:</strong> ${council.contact}</p>
                    </div>
                    <button class="btn-danger remove-council" data-id="${council.id}">
                        <i class="fas fa-trash"></i>
                        Usu
                    </button>
                `;
                councilsList.appendChild(councilItem);
            });

            // Dodanie nasuchiwania na przyciski usuwania
            document.querySelectorAll('.remove-council').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const councilId = e.target.closest('.remove-council').getAttribute('data-id');
                    removeCouncil(councilId);
                });
            });
        }

        function removeCouncil(councilId) {
            if (confirm('Czy na pewno chcesz usun t rad/organizacj?')) {
                showLoading();
                
                deleteCouncil(councilId)
                    .then(() => {
                        councils = councils.filter(council => council.id !== councilId);
                        renderCouncils();
                        hideLoading();
                        showNotification('Rada/Organizacja zostaa usunita!', 'success');
                    })
                    .catch((error) => {
                        hideLoading();
                        showNotification('Bd usuwania rady/organizacji: ' + error.message, 'error');
                    });
            }
        }

        function renderCompetences() {
            competencesList.innerHTML = '';

            if (competences.length === 0) {
                competencesList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-tools"></i>
                        <p>Brak dodanych kompetencji.</p>
                    </div>
                `;
                return;
            }

            competences.forEach(competence => {
                const competenceItem = document.createElement('div');
                competenceItem.className = 'competence-item';
                competenceItem.innerHTML = `
                    <div>
                        <h4>${competence.name}</h4>
                        <p>Liczba os贸b: ${competence.people.length}</p>
                    </div>
                    <div class="action-buttons">
                        <button class="view-competence" data-id="${competence.id}">
                            <i class="fas fa-eye"></i>
                            Szczeg贸y
                        </button>
                        <button class="btn-danger remove-competence" data-id="${competence.id}">
                            <i class="fas fa-trash"></i>
                            Usu
                        </button>
                    </div>
                `;
                competencesList.appendChild(competenceItem);
            });

            // Dodanie nasuchiwania na przyciski
            document.querySelectorAll('.view-competence').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const competenceId = e.target.closest('.view-competence').getAttribute('data-id');
                    viewCompetence(competenceId);
                });
            });

            document.querySelectorAll('.remove-competence').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const competenceId = e.target.closest('.remove-competence').getAttribute('data-id');
                    removeCompetence(competenceId);
                });
            });
        }

        function viewCompetence(competenceId) {
            currentCompetence = competences.find(c => c.id === competenceId);
            if (currentCompetence) {
                competenceName.textContent = currentCompetence.name;

                // Wywietl list os贸b
                competencePeopleList.innerHTML = '';

                if (currentCompetence.people.length === 0) {
                    competencePeopleList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-users"></i>
                            <p>Brak os贸b z t kompetencj.</p>
                        </div>
                    `;
                } else {
                    currentCompetence.people.forEach(person => {
                        const personItem = document.createElement('li');
                        personItem.className = 'person-item';
                        personItem.innerHTML = `
                            <span>${person}</span>
                        `;
                        competencePeopleList.appendChild(personItem);
                    });
                }

                competenceDetails.classList.remove('hidden');
            }
        }

        function removeCompetence(competenceId) {
            if (confirm('Czy na pewno chcesz usun t kompetencj?')) {
                showLoading();
                
                deleteCompetence(competenceId)
                    .then(() => {
                        competences = competences.filter(competence => competence.id !== competenceId);
                        renderCompetences();
                        
                        if (currentCompetence && currentCompetence.id === competenceId) {
                            competenceDetails.classList.add('hidden');
                            currentCompetence = null;
                        }
                        
                        hideLoading();
                        showNotification('Kompetencja zostaa usunita!', 'success');
                    })
                    .catch((error) => {
                        hideLoading();
                        showNotification('Bd usuwania kompetencji: ' + error.message, 'error');
                    });
            }
        }

        function filterCompetences() {
            const filterValue = competenceFilter.value.toLowerCase();

            document.querySelectorAll('.competence-item').forEach(item => {
                const competenceName = item.querySelector('h4').textContent.toLowerCase();
                if (competenceName.includes(filterValue)) {
                    item.style.display = 'flex';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Funkcje eksportu i importu
        function handleExportTeam() {
            if (!currentTeam) return;

            const dataStr = JSON.stringify(currentTeam, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);

            const exportFileDefaultName = `${currentTeam.name.replace(/\s+/g, '_')}.json`;

            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();

            showNotification(`Dane podzespou "${currentTeam.name}" zostay wyeksportowane!`, 'success');
        }

        function handleExportAll() {
            const allData = {
                teams: teams,
                councils: councils,
                competences: competences
            };

            const dataStr = JSON.stringify(allData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);

            const exportFileDefaultName = `teamorganizer_backup_${formatDateForExport(new Date())}.json`;

            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();

            showNotification('Wszystkie dane zostay wyeksportowane!', 'success');
        }

        function handleImportTeam() {
            const fileInput = document.getElementById('import-team-file');
            const file = fileInput.files[0];

            if (!file) {
                showNotification('Prosz wybra plik do importu', 'error');
                return;
            }

            showLoading();
            
            const reader = new FileReader();
            reader.onload = function (e) {
                try {
                    const importedTeam = JSON.parse(e.target.result);

                    // Sprawd藕 czy to poprawny zesp贸
                    if (!importedTeam.name || !importedTeam.members) {
                        throw new Error('Nieprawidowy format pliku');
                    }

                    // Nadaj nowe ID aby unikn konflikt贸w
                    delete importedTeam.id;

                    saveTeam(importedTeam)
                        .then((docRef) => {
                            importedTeam.id = docRef.id;
                            teams.push(importedTeam);
                            renderTeams();
                            fileInput.value = '';
                            hideLoading();
                            showNotification(`Podzesp贸 "${importedTeam.name}" zosta zaimportowany!`, 'success');
                        })
                        .catch((error) => {
                            hideLoading();
                            showNotification('Bd importowania: ' + error.message, 'error');
                        });
                } catch (error) {
                    hideLoading();
                    showNotification('Bd podczas importowania pliku: ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
        }

        // Pomocnicze funkcje
        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('pl-PL', options);
        }

        function formatDateForExport(date) {
            return date.toISOString().slice(0, 10).replace(/-/g, '');
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;

            let icon = '';
            switch (type) {
                case 'success':
                    icon = '<i class="fas fa-check-circle"></i>';
                    break;
                case 'error':
                    icon = '<i class="fas fa-exclamation-circle"></i>';
                    break;
                default:
                    icon = '<i class="fas fa-info-circle"></i>';
            }

            notification.innerHTML = `${icon} ${message}`;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function showLoading() {
            loadingScreen.classList.remove('hidden');
        }

        function hideLoading() {
            loadingScreen.classList.add('hidden');
        }

        // Inicjalizacja aplikacji po zaadowaniu DOM
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>

</html>

